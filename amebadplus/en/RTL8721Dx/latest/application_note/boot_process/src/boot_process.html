<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Features &mdash; amebadplus_docs  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/toggleprompt.js?v=d7ede5d2"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="User Configuration" href="../../user_config/src/index.html" />
    <link rel="prev" title="Boot Process" href="index.html" />  
     
  <script type="text/javascript" src="../../../_static/js/selector.js"></script>
<style>
      .wy-nav-content {
      max-width: 1000px; /* 设置最大宽度 */
      }
</style>



</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            amebadplus_docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../product_overview/src/index.html">Product Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/src/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ameba/en/at_command/src/index.html">AT Command</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Application Note</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../gcc_build_environment/src/index.html">GCC Build Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_architecture/src/index.html">SDK Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gcc_makefile/src/index.html">GCC Makefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sdk_example/src/index.html">SDK Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flash_memory_layout/index.html">Flash and Memory Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mpu_cache/src/index.html">MPU and Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_system/src/index.html">Virtual File System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mp_image/src/index.html">MP Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ota/src/index.html">OTA Firmware Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chip_en/src/index.html">CHIP Enable</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Boot Process</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-address">Boot Address</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pin-description">Pin Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boot-flow">Boot Flow</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#boot-api">Boot API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_config/src/index.html">User Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware_crypto_engine/src/index.html">Hardware Crypto Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../otpc/src/index.html">One-time Programmable Controller (OTPC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../power_save/src/index.html">Power Saving</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ipc/src/index.html">Inter-Processor Communication (IPC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dmac/src/index.html">Direct Memory Access Controller (DMAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../psram/src/index.html">Pseudo-Static Random Access Memory (PSRAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gpio/gpio/src/index.html">General Purpose Input/Output (GPIO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gpio/pinctrl/src/index.html">Pin Controller (Pinctrl)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pinmux/src/index.html">Pin Multiplexing Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rtc_io/src/index.html">RTC_IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ir/src/index.html">Infrared Radiation (IR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ledc/src/index.html">Light Emitting Diode Controller (LEDC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trng/src/index.html">True Random Number Generator (TRNG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../adc/src/index.html">Analog-to-Digital Converter (ADC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cap_touch/src/index.html">Cap-Touch Controller (CTC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../key_scan/src/index.html">Key-Scan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../audio/src/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usb_otg/src/index.html">USB OTG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wifi/index.html">Wi-Fi</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ameba/en/software_tools/index.html">Software Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ameba/en/mp_tools/src/index.html">MP Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">amebadplus_docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Application Note</a></li>
          <li class="breadcrumb-item"><a href="index.html">Boot Process</a></li>
      <li class="breadcrumb-item active">Features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/application_note/boot_process/src/boot_process.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="features">
<span id="boot-process"></span><h1>Features<a class="headerlink" href="#features" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p>On-chip boot ROM</p></li>
<li><p>Contains the bootloader with In-System Programming (ISP) facility</p></li>
<li><p>Secure boot process with multiple cryptographic algorithms of hardware or software engine</p></li>
<li><p>Suspend resume process</p></li>
<li><p>Boot from NOR flash</p></li>
<li><p>PSRAM as a memory</p></li>
</ul>
</section>
<section id="boot-address">
<h1>Boot Address<a class="headerlink" href="#boot-address" title="Link to this heading"></a></h1>
<p>After reset, CPU will boot from the vector table start address, which is fixed by hardware. Both KM4 and KM0 boot from address <code class="docutils literal notranslate"><span class="pre">0x0000_0000</span></code>.</p>
<table class="docutils align-default" id="id1" style="width: 100%">
<caption><span class="caption-text">Boot address</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>CPU</p></th>
<th class="head"><p>Address</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>KM4</p></td>
<td><p>0x0000_0000</p></td>
<td><p>KM4 ITCM ROM</p></td>
</tr>
<tr class="row-odd"><td><p>KM0</p></td>
<td><p>0x0000_0000</p></td>
<td><p>KM0 ITCM ROM</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pin-description">
<h1>Pin Description<a class="headerlink" href="#pin-description" title="Link to this heading"></a></h1>
<p>The AmebaDPlus supports ISP via LOGUART (<code class="docutils literal notranslate"><span class="pre">PB4</span></code> and <code class="docutils literal notranslate"><span class="pre">PB5</span></code>). The ISP mode is determined by the state of <code class="docutils literal notranslate"><span class="pre">PB5</span></code> when boot.</p>
<table class="docutils align-default" id="id2" style="width: 100%">
<caption><span class="caption-text">ISP mode</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Boot Mode</p></th>
<th class="head"><p>PB5 (UART_DOWNLOAD)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No ISP</p></td>
<td><p>HIGH</p></td>
<td><p>ISP bypassed. Part attempts to boot from Flash.</p></td>
</tr>
<tr class="row-odd"><td><p>ISP</p></td>
<td><p>LOW</p></td>
<td><p>Part enters ISP via LOGUART.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="boot-flow">
<h1>Boot Flow<a class="headerlink" href="#boot-flow" title="Link to this heading"></a></h1>
<p>The boot flow of AmebaDPlus is illustrated below. After a power-up or hardware reset, the hardware will boot KM4 at 150MHz. The boot process is handled by the on-chip boot ROM and is always executed by the KM4. After the KM4 bootloader code, the KM4 will set up the environment for the KM0.</p>
<ul class="simple">
<li><p>KM4 boots ROM</p></li>
<li><p>KM4 secure boot (optional)</p></li>
<li><p>KM4 boots to SRAM</p></li>
<li><p>KM4 helps KM0 load images and check the signature (optional)</p></li>
</ul>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../../_images/boot_flow.svg"><img alt="../../../_images/boot_flow.svg" height="298" src="../../../_images/boot_flow.svg" width="975" /></a>
<figcaption>
<p><span class="caption-text">Boot flow</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The immutable ROM provides ISP service, which could be initial programming of a blank device, erasing and re-programming of a previously programmed device.</p>
<p>When the rising edge on RESET pin is generated, the trap pin (<code class="docutils literal notranslate"><span class="pre">PB5</span></code>) will be sampled to determine whether to continue the boot process or ISP service. If the trap pin is sampled LOW, the external hardware requests to start the ISP service. Otherwise, the chip boots normally.</p>
</section>
<section id="boot-api">
<h1>Boot API<a class="headerlink" href="#boot-api" title="Link to this heading"></a></h1>
<p>The boot API is used to obtain the cause of the chip boot, and the function prototype is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u32</span> <span class="n">BOOT_Reason</span><span class="p">(</span><span class="n">void</span><span class="p">);</span>
</pre></div>
</div>
<p>The default return value of this API is <code class="docutils literal notranslate"><span class="pre">0</span></code> when initially powered on, and return value of re-boot caused by other reasons can be found in the following table. Users can found macro-definitions about return value in file <code class="docutils literal notranslate"><span class="pre">sysreg_aon.h</span></code>.</p>
<table class="docutils align-default" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Items</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Introduction</p></td>
<td><p>Get boot reason</p></td>
</tr>
<tr class="row-odd"><td><p>Parameters</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Return</p></td>
<td><p>Boot reason. It can be any of the following values or combinations:</p>
<ul class="simple">
<li><p>AON_BIT_RSTF_OCP: Enter deep-sleep mode when OCP happens</p></li>
<li><p>AON_BIT_RSTF_KM0_SYS: KM0 system reset</p></li>
<li><p>AON_BIT_RSTF_KM4_SYS: KM4 system reset</p></li>
<li><p>AON_BIT_RSTF_IWDG: KM0 independent watchdog reset</p></li>
<li><p>AON_BIT_RSTF_WDG0: KM0 watchdog reset</p></li>
<li><p>AON_BIT_RSTF_WDG1: KM4 secure watchdog reset</p></li>
<li><p>AON_BIT_RSTF_WDG2: KM4 non-secure watchdog reset</p></li>
<li><p>AON_BIT_RSTF_WARM_KM42PERI: KM4 warm reset</p></li>
<li><p>AON_BIT_RSTF_WARM_KM02PERI: KM0 warm reset</p></li>
<li><p>AON_BIT_RSTF_DSLP: Wakeup from deep-sleep mode</p></li>
<li><p>AON_BIT_RSTF_BOR: BOR Reset</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Boot Process" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../user_config/src/index.html" class="btn btn-neutral float-right" title="User Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Realsil.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>